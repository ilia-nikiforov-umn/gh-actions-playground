name: Testing

on: [push]

jobs:
    helloworld:
        strategy:
          matrix:
            os: [ubuntu-22.04, macos-latest]
        
        runs-on: ${{ matrix.os }}

        steps:
            - name: Aggressive cleanup
              run: |
                # Remove Java (JDKs)
                sudo rm -rf /usr/lib/jvm
            
                # Remove .NET SDKs
                sudo rm -rf /usr/share/dotnet
            
                # Remove Swift toolchain
                sudo rm -rf /usr/share/swift
            
                # Remove Haskell (GHC)
                sudo rm -rf /usr/local/.ghcup
            
                # Remove Julia
                sudo rm -rf /usr/local/julia*
            
                # Remove Android SDKs
                sudo rm -rf /usr/local/lib/android
            
                # Remove Chromium (optional if not using for browser tests)
                sudo rm -rf /usr/local/share/chromium
            
                # Remove Microsoft/Edge and Google Chrome builds
                sudo rm -rf /opt/microsoft /opt/google
            
                # Remove Azure CLI
                sudo rm -rf /opt/az
            
                # Remove PowerShell
                sudo rm -rf /usr/local/share/powershell
            
                # Remove CodeQL and other toolcaches
                sudo rm -rf /opt/hostedtoolcache
            
                docker system prune -af || true
                docker builder prune -af || true
                df -h
        
            - name: list python modules
              run: |
                python -m pip list
            - name: print interesting github variables
              run: |
                printf ${{ github.repository }}
                printf ${{ runner.os }}
            - name: install aflow
              if: runner.os == 'macOS'
              run: |
                units eV J
                brew tap aflow-org/aflow
                brew install aflow 
                aflow --version
